// SPDX-License-Identifier: MIT
pragma solidity ^0.8.21;

/// @title WormSpawner - Deploys clones using provided bytecode
contract WormSpawner {
    address public controller;
    address[] public clones;

    constructor() {
        controller = msg.sender;
    }

    function deploy(bytes memory bytecode) external {
        require(msg.sender == controller, "Not authorized");
        address clone;
        assembly {
            clone := create(0, add(bytecode, 0x20), mload(bytecode))
        }
        require(clone != address(0), "Deployment failed");
        clones.push(clone);
    }

    function cloneCount() external view returns (uint256) {
        return clones.length;
    }

    function cloneAt(uint256 index) external view returns (address) {
        return clones[index];
    }
}
