// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.21;

import "forge-std/Test.sol";
import "../../masquerade/FakeOracle.sol";
import "../../masquerade/OracleRegistry.sol";

contract FakeOracleTest is Test {
    OracleRegistry public registry;
    FakeOracle public fakeOracle;
    address attacker = address(0xBEEF);

    function setUp() public {
        registry = new OracleRegistry();
        fakeOracle = new FakeOracle(42e8, attacker); // fake high price
        registry.register("ETH/USD", address(fakeOracle));
    }

    function testFakeOracleInjection() public {
        int256 spoofed = registry.getPrice("ETH/USD");
        assertEq(spoofed, 42e8, "Should return spoofed price");
    }
}
